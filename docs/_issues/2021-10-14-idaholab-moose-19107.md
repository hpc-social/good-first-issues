---
tags: C-TestHarness,Good-first-issue,T-task
title: "Confusing, overlapping TestHarness Arguments should be cleaned up"
html_url: "https://github.com/idaholab/moose/issues/19107"
user: permcody
repo: idaholab/moose
---

## Reason
<!--Why do you need this feature or what is the enhancement?-->

Right now we have three arguments in the TestHarness that impact the way "test spec files" or directories where there are tests are found and run:

- `-i <spec_file>` allows users to pick a different file name that will contain the test specifications for each directory, by default this file is usually called `tests` and is a HIT formatted file.
- `--test-root` allows users to pick a different starting path to traverse for "test spec files". Normally this is the root of the repository, but can be modified. This option works in concert with the `-I` option.
- `--spec-file` This option was added so that a single directory of tests could be run with no recursion or searching. 

The issue is that for whatever reason, `--spec-file` currently accepts both a directory or a full path ending in a file and behaves very differently in these modes. If a directory is supplied, it'll behave identically to `--test-root`. If it's a full file path, it'll run just a single directory worth of tests, but unfortunately, the logic to do so is very convoluted because the recursive loop is not bypassed in this case. A lot of gymnastics are being done to avoid doing the recursion in that case.

## Design
<!--A concise description (design) of the enhancement.--->

While it would be trivial to just fix up the logic and not allow `--spec-file` to fallback to `--test-root` behavior, we should take the opportunity to refactor a bit. `FindAndRunTests` is not a good subroutine design. It should be broken into at least two functions if not more (i.e `Run`, `FindSpecFiles`, and `RunTestsInDir`). The `--spec-file` option would not use the "Find" method cleaning up the logic.

## Impact
<!--Will the enhancement change existing APIs or add something new?-->

Minor, refactoring cleanup although some CIVET recipes that are exploring `--spec-file` in the `--test-root` fallback mode will have to be updated prior to this change being merged, but that can be done independently.
