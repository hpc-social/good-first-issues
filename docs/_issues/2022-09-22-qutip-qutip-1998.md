---
tags: ,BUG,medium
title: "Sparse Eigensolver issue."
html_url: "https://github.com/qutip/qutip/issues/1998"
user: Ericgig
repo: qutip/qutip
---

### Bug Description

The sparse eigensolver can fail when eigenvalues are purely imaginary.

### Code to Reproduce the Bug

```shell
import qutip 
(qutip.num(4) * 1j).eigenenergies(sparse=True)
```


### Code Output

```shell
array([-3.33066907e-16+3.j, -1.06901857e-16+1.j,  1.03300843e-16+1.j,
        4.44089210e-16+3.j])
```


### Expected Behaviour

All unique eigenstates should be returned.

### Your Environment

```shell
Present in both `master` and `dev.major`.
```


### Additional Context

_No response_