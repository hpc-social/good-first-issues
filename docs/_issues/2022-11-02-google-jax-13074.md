---
tags: ,better_errors
title: "improve pjit pytree error involving Nones (and PytreeLeafs)"
html_url: "https://github.com/google/jax/issues/13074"
user: mattjj
repo: google/jax
---

When pjit's `in_axis_resoures` is not a pytree prefix of the corresponding arguments' pytrees, we attempt to raise a good error. But at least two things can be improved:
* [ ] don't mention PytreeLeaf instances in the error message
* [ ] handle None specially (since it's surprising for the error message to refer to it as a container)